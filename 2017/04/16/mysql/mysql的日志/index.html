<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>mysql的日志 | Chen&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1.错误日志1.1.配置错误日志1234567891011121314151617#1.在配置文件中指定vim /data/3306/my.cnf[mysqld_safe]log-error=/data/3309/mysql_oldboy3309.err#2.在启动命令中加入 mysql_safe --defaults-file=/data/3306/my.cnf --log-error=/dat">
<meta name="keywords" content="mysql">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql的日志">
<meta property="og:url" content="http://yoursite.com/2017/04/16/mysql/mysql的日志/index.html">
<meta property="og:site_name" content="Chen's Blog">
<meta property="og:description" content="1.错误日志1.1.配置错误日志1234567891011121314151617#1.在配置文件中指定vim /data/3306/my.cnf[mysqld_safe]log-error=/data/3309/mysql_oldboy3309.err#2.在启动命令中加入 mysql_safe --defaults-file=/data/3306/my.cnf --log-error=/dat">
<meta property="og:image" content="http://ols7leonh.bkt.clouddn.com//assert/img/mysql/binlog/1.png">
<meta property="og:image" content="http://ols7leonh.bkt.clouddn.com//assert/img/mysql/binlog/2.png">
<meta property="og:image" content="http://ols7leonh.bkt.clouddn.com//assert/img/mysql/binlog/3.png">
<meta property="og:updated_time" content="2017-02-24T17:10:01.255Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mysql的日志">
<meta name="twitter:description" content="1.错误日志1.1.配置错误日志1234567891011121314151617#1.在配置文件中指定vim /data/3306/my.cnf[mysqld_safe]log-error=/data/3309/mysql_oldboy3309.err#2.在启动命令中加入 mysql_safe --defaults-file=/data/3306/my.cnf --log-error=/dat">
<meta name="twitter:image" content="http://ols7leonh.bkt.clouddn.com//assert/img/mysql/binlog/1.png">
  
    <link rel="alternate" href="/atom.xml" title="Chen&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Chen&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">一个技术渣的自说自话</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-mysql/mysql的日志" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/16/mysql/mysql的日志/" class="article-date">
  <time datetime="2017-04-16T04:47:25.723Z" itemprop="datePublished">2017-04-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/mysql/">mysql</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      mysql的日志
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-错误日志"><a href="#1-错误日志" class="headerlink" title="1.错误日志"></a>1.错误日志</h1><h2 id="1-1-配置错误日志"><a href="#1-1-配置错误日志" class="headerlink" title="1.1.配置错误日志"></a>1.1.配置错误日志</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">#1.在配置文件中指定</div><div class="line">vim /data/3306/my.cnf</div><div class="line">[mysqld_safe]</div><div class="line">log-error=/data/3309/mysql_oldboy3309.err</div><div class="line"></div><div class="line">#2.在启动命令中加入</div><div class="line"> mysql_safe --defaults-file=/data/3306/my.cnf --log-error=/data/3306/mysql_oldboy.err</div><div class="line"> </div><div class="line"></div><div class="line"></div><div class="line">#3.在mysql客户端查看error log 的位置</div><div class="line">mysql&gt; show variables like &apos;log_error%&apos;;</div><div class="line">+---------------+---------------------------------+</div><div class="line">| Variable_name | Value                           |</div><div class="line">+---------------+---------------------------------+</div><div class="line">| log_error     | /data/3309/mysql_oldboy3309.err |</div><div class="line">+---------------+---------------------------------+</div></pre></td></tr></table></figure>
<h1 id="2-普通日志"><a href="#2-普通日志" class="headerlink" title="2.普通日志"></a>2.普通日志</h1><p>记录客户端连接的信息和执行的sql语句的信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> </div><div class="line">mysql&gt; show variables like &apos;general_log%&apos;;</div><div class="line">+------------------+---------------------------+</div><div class="line">| Variable_name    | Value                     |</div><div class="line">+------------------+---------------------------+</div><div class="line">| general_log      | OFF                       |</div><div class="line">| general_log_file | /data/3309/data/MySQL.log |</div><div class="line">+------------------+---------------------------+</div><div class="line"></div><div class="line"></div><div class="line">#在生产环境下，我们是关闭的，因为mysql的瓶颈就是磁盘IO，而这样的日志很多，将会产生IO，所以我们是关闭的，开启的方法如下：</div><div class="line">mysql&gt;set global general_log = on</div><div class="line"></div><div class="line">#在配置文件中修改</div><div class="line">general_log = on</div><div class="line">general_log_file = /data/3306/data/MySQL_oldboy.log</div></pre></td></tr></table></figure></p>
<h1 id="3-慢查询日志"><a href="#3-慢查询日志" class="headerlink" title="3.慢查询日志"></a>3.慢查询日志</h1><p> 执行时间超过指定时间的sql语句,利用慢查询来的优化sql</p>
<h2 id="3-1-开启慢查询日志"><a href="#3-1-开启慢查询日志" class="headerlink" title="3.1.开启慢查询日志"></a>3.1.开启慢查询日志</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#慢查询的设置对数据的sql优化非常重要</div><div class="line">#vim /data/3306/my.cnf</div><div class="line">long_query_time=1        //超过1s 的查询语句</div><div class="line">log-slow-queries=/data/3306/slow.log</div><div class="line">log_queries_not_using_indexs         //没有使用索引的语句</div></pre></td></tr></table></figure>
<h2 id="3-2-慢查询日志切割"><a href="#3-2-慢查询日志切割" class="headerlink" title="3.2.慢查询日志切割"></a>3.2.慢查询日志切割</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">cd /server/scripts/</div><div class="line">vim cut_slow_log.sh</div><div class="line">cd /data/3309/ &amp;&amp;\</div><div class="line">/bin/mv slow.log slow.log.$(date +%F) &amp;&amp;\</div><div class="line">mysqladmin -uroot -poldboy123 -S /data/3309/mysql.sock  flush-log</div></pre></td></tr></table></figure>
<h2 id="3-3-使用工具mysqlsla分析慢查询，定时发送邮件给相关人员"><a href="#3-3-使用工具mysqlsla分析慢查询，定时发送邮件给相关人员" class="headerlink" title="3.3.使用工具mysqlsla分析慢查询，定时发送邮件给相关人员"></a>3.3.使用工具mysqlsla分析慢查询，定时发送邮件给相关人员</h2><p>参见文档：mysqlsla日志分析工具.md</p>
<h1 id="4-二进制日志"><a href="#4-二进制日志" class="headerlink" title="4.二进制日志"></a>4.二进制日志</h1><h2 id="4-1-设置开启"><a href="#4-1-设置开启" class="headerlink" title="4.1.设置开启"></a>4.1.设置开启</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@lamp01 data]# grep log-bin /data/3306/my.cnf</div><div class="line">log-bin = /data/3306/mysql-bin</div></pre></td></tr></table></figure>
<h2 id="4-2-作用"><a href="#4-2-作用" class="headerlink" title="4.2.作用"></a>4.2.作用</h2><p>log-bin的作用:</p>
<ul>
<li>记录更改的SQL语句</li>
<li>主从复制</li>
<li>增量备份</li>
</ul>
<h2 id="4-3-清除binlog日志"><a href="#4-3-清除binlog日志" class="headerlink" title="4.3.清除binlog日志"></a>4.3.清除binlog日志</h2><p>mysql&gt;reset master</p>
<h1 id="5-记录日志的三种模式"><a href="#5-记录日志的三种模式" class="headerlink" title="5.记录日志的三种模式"></a>5.记录日志的三种模式</h1><h2 id="5-1-行模式-Row-Level"><a href="#5-1-行模式-Row-Level" class="headerlink" title="5.1.行模式(Row Level)"></a>5.1.行模式(Row Level)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">日志中会记录每一行数据被修改</div><div class="line">举例：update teacher set name=”zhangsan”;</div><div class="line">上述语句在binlog就会被解析成</div><div class="line"></div><div class="line">update teacher set name=”zhangsan” where id=1</div><div class="line">update teacher set name=”zhangsan” where id=2</div><div class="line">update teacher set name=”zhangsan” where id=3</div><div class="line">//..................</div><div class="line"> </div><div class="line">#缺点：会产生大量的binlog日志</div></pre></td></tr></table></figure>
<h2 id="5-2-语句级别（Statement-Level）"><a href="#5-2-语句级别（Statement-Level）" class="headerlink" title="5.2.语句级别（Statement Level）"></a>5.2.语句级别（Statement Level）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#mysql的默认级别</div><div class="line">#举例：update teacher set name=”zhangsan”;</div><div class="line">#上述语句在binlog就会被解析成</div><div class="line"></div><div class="line">update teacher set name=”zhangsan”;</div></pre></td></tr></table></figure>
<h2 id="5-3-mixed"><a href="#5-3-mixed" class="headerlink" title="5.3.mixed"></a>5.3.mixed</h2><p>是上述两种模式的结合，智能选择其中的一种</p>
<h1 id="6-设置binlog的记录模式"><a href="#6-设置binlog的记录模式" class="headerlink" title="6.设置binlog的记录模式"></a>6.设置binlog的记录模式</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">#在配置文件中修改</div><div class="line">log-bin=mysql-bin</div><div class="line">#binlog_format=&quot;STATEMENT&quot;</div><div class="line">#binlog_format=&quot;ROW&quot;</div><div class="line">#binlog_format=&quot;MIXED&quot;</div><div class="line"></div><div class="line"></div><div class="line">#运行时在线修改</div><div class="line">mysql&gt; SET SESSION binlog_format = &apos;STATEMENT&apos;;</div><div class="line">mysql&gt; SET SESSION binlog_format = &apos;ROW&apos;;</div><div class="line">mysql&gt; SET SESSION binlog_format = &apos;MIXED&apos;;</div><div class="line"></div><div class="line"></div><div class="line">#查看</div><div class="line">mysql&gt; show variables like &quot;binlog_format%&quot;;</div><div class="line">+---------------+-----------+</div><div class="line">| Variable_name | Value     |</div><div class="line">+---------------+-----------+</div><div class="line">| binlog_format | STATEMENT |</div><div class="line">+---------------+-----------+</div></pre></td></tr></table></figure>
<h1 id="7-使用mysqlbinlog提取二进制日志"><a href="#7-使用mysqlbinlog提取二进制日志" class="headerlink" title="7.使用mysqlbinlog提取二进制日志"></a>7.使用mysqlbinlog提取二进制日志</h1><h2 id="7-1-提取指定的binlog日志"><a href="#7-1-提取指定的binlog日志" class="headerlink" title="7.1.提取指定的binlog日志"></a>7.1.提取指定的binlog日志</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[root@lamp01 3306]# mysqlbinlog /data/3306/mysql-bin.000002|grep insert</div><div class="line">/*!40019 SET @@session.max_insert_delayed_threads=0*/;</div><div class="line">insert into student values(1,&quot;zhangsan2222222&quot;)</div><div class="line">insert into student values(1,&quot;lisi&quot;)</div><div class="line">insert into student values(2,&quot;lisi2&quot;)</div><div class="line">[root@lamp01 3306]#</div></pre></td></tr></table></figure>
<h2 id="7-2-提取指定position位置的binlog日志"><a href="#7-2-提取指定position位置的binlog日志" class="headerlink" title="7.2.提取指定position位置的binlog日志"></a>7.2.提取指定position位置的binlog日志</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysqlbinlog --start-position=&quot;120&quot; --stop-position=&quot;332&quot; /opt/data/APP01bin.000001</div></pre></td></tr></table></figure>
<h2 id="7-3-提取指定position位置的binlog日志并输出到压缩文件"><a href="#7-3-提取指定position位置的binlog日志并输出到压缩文件" class="headerlink" title="7.3.提取指定position位置的binlog日志并输出到压缩文件"></a>7.3.提取指定position位置的binlog日志并输出到压缩文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysqlbinlog --start-position=&quot;120&quot; --stop-position=&quot;332&quot; /opt/data/APP01bin.000001 |gzip &gt;extra_01.sql.gz</div></pre></td></tr></table></figure>
<h2 id="7-4-提取指定position位置的binlog日志导入数据库"><a href="#7-4-提取指定position位置的binlog日志导入数据库" class="headerlink" title="7.4.提取指定position位置的binlog日志导入数据库"></a>7.4.提取指定position位置的binlog日志导入数据库</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysqlbinlog --start-position=&quot;120&quot; --stop-position=&quot;332&quot; /opt/data/APP01bin.000001 | mysql -uroot -p</div></pre></td></tr></table></figure>
<h2 id="7-5-提取指定开始时间的binlog并输出到sql文件"><a href="#7-5-提取指定开始时间的binlog并输出到sql文件" class="headerlink" title="7.5.提取指定开始时间的binlog并输出到sql文件"></a>7.5.提取指定开始时间的binlog并输出到sql文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysqlbinlog --start-datetime=&quot;2014-12-15 20:15:23&quot; /opt/data/APP01bin.000002 --result-file=extra02.sql</div></pre></td></tr></table></figure>
<h2 id="7-6-提取指定位置的多个binlog日志文件"><a href="#7-6-提取指定位置的多个binlog日志文件" class="headerlink" title="7.6.提取指定位置的多个binlog日志文件"></a>7.6.提取指定位置的多个binlog日志文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysqlbinlog --start-position=&quot;120&quot; --stop-position=&quot;332&quot; /opt/data/APP01bin.000001 /opt/data/APP01bin.000002|more</div></pre></td></tr></table></figure>
<h2 id="7-7-提取指定数据库binlog并转换字符集到UTF8"><a href="#7-7-提取指定数据库binlog并转换字符集到UTF8" class="headerlink" title="7.7.提取指定数据库binlog并转换字符集到UTF8"></a>7.7.提取指定数据库binlog并转换字符集到UTF8</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> mysqlbinlog --database=test --set-charset=utf8 /opt/data/APP01bin.000001 /opt/data/APP01bin.000002 &gt;test.sql  </div><div class="line"></div><div class="line">#&gt;test.sql 也是输出到一个sql文件中</div></pre></td></tr></table></figure>
<h2 id="7-8-远程提取日志，指定结束时间"><a href="#7-8-远程提取日志，指定结束时间" class="headerlink" title="7.8.远程提取日志，指定结束时间"></a>7.8.远程提取日志，指定结束时间</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysqlbinlog -urobin -p -h192.168.1.116 -P3306 --stop-datetime=&quot;2014-12-15 20:30:23&quot; --read-from-remote-server mysql-bin.000033 |more</div></pre></td></tr></table></figure>
<h2 id="7-9-远程提取使用row格式的binlog日志并输出到本地文件"><a href="#7-9-远程提取使用row格式的binlog日志并输出到本地文件" class="headerlink" title="7.9.远程提取使用row格式的binlog日志并输出到本地文件"></a>7.9.远程提取使用row格式的binlog日志并输出到本地文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysqlbinlog -urobin -p -P3606 -h192.168.1.177 --read-from-remote-server -vv inst3606bin.000005 &gt;row.sql</div></pre></td></tr></table></figure>
<h1 id="8-binlog命令的参数"><a href="#8-binlog命令的参数" class="headerlink" title="8.binlog命令的参数"></a>8.binlog命令的参数</h1><h2 id="8-1-–base64-output"><a href="#8-1-–base64-output" class="headerlink" title="8.1.–base64-output"></a>8.1.–base64-output</h2><p>&emsp;对于不同的日志模式，生成的binlog有不同的记录方式。对于MIXED(部分SQL语句)和ROW模式是以base-64方式记录，会以BINLOG开头，是一段伪SQL，我们可以用使用base64-output参数来抑制其显示</p>
<p><img src="http://ols7leonh.bkt.clouddn.com//assert/img/mysql/binlog/1.png" alt=""></p>
<p><img src="http://ols7leonh.bkt.clouddn.com//assert/img/mysql/binlog/2.png" alt=""></p>
<p><img src="http://ols7leonh.bkt.clouddn.com//assert/img/mysql/binlog/3.png" alt=""></p>
<h2 id="8-2-–verbose-v"><a href="#8-2-–verbose-v" class="headerlink" title="8.2.–verbose(-v)"></a>8.2.–verbose(-v)</h2><p>选项可以获取更多的可读信息，但是并不是一个原始的SQL语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@MySQL 3309]# mysqlbinlog --base64-output=&quot;decode-row&quot; -v mysql-bin.000001</div></pre></td></tr></table></figure></p>
<h2 id="8-3-d-指定数据库"><a href="#8-3-d-指定数据库" class="headerlink" title="8.3.-d 指定数据库"></a>8.3.-d 指定数据库</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">[root@MySQL 3309]# mysqlbinlog mysql-bin.000002|egrep -v &quot;^$|^#|^\/\*|^SET|BEGIN|COMMIT|DELIMIT|ROLL|&apos;&quot;          </div><div class="line">gAyxVw8BAAAAZwAAAGsAAAABAAQANS41LjUxLWxvZwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</div><div class="line">AAAAAAAAAAAAAAAAAACADLFXEzgNAAgAEgAEBAQEEgAAVAAEGggAAAAICAgCAA==</div><div class="line">use `teacher`/*!*/;</div><div class="line">DROP TABLE `t1` /* generated by server */</div><div class="line">DROP TABLE `t2` /* generated by server */</div><div class="line">insert into t3(id,name) values(33,&quot;chenyansong&quot;)</div><div class="line">insert into t3(id,name,age) values(333,&quot;chenyansong&quot;,33)</div><div class="line">drop database tst_t1</div><div class="line">drop database tst_t2</div><div class="line"> </div><div class="line">#指定数据库</div><div class="line">[root@MySQL 3309]# mysqlbinlog -d teacher mysql-bin.000002|egrep -v &quot;^$|^#|^\/\*|^SET|BEGIN|COMMIT|DELIMIT|ROLL|&apos;&quot;</div><div class="line">gAyxVw8BAAAAZwAAAGsAAAABAAQANS41LjUxLWxvZwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</div><div class="line">AAAAAAAAAAAAAAAAAACADLFXEzgNAAgAEgAEBAQEEgAAVAAEGggAAAAICAgCAA==</div><div class="line">use `teacher`/*!*/;</div><div class="line">DROP TABLE `t1` /* generated by server */</div><div class="line">DROP TABLE `t2` /* generated by server */</div><div class="line">insert into t3(id,name) values(33,&quot;chenyansong&quot;)</div><div class="line">insert into t3(id,name,age) values(333,&quot;chenyansong&quot;,33)</div><div class="line"> </div><div class="line">insert into teacher.t3(id,name,age) values(8,&quot;lisi_4&quot;,22)</div><div class="line">#上面的语句就不会计入分库binlog，只有我们使用use的时候，才会在-d的时候计入分库</div></pre></td></tr></table></figure>
<h1 id="9-删除二进制日志"><a href="#9-删除二进制日志" class="headerlink" title="9.删除二进制日志"></a>9.删除二进制日志</h1><p>&emsp;随着时间的推移，二进制日志也会变得很多很大，因此，有必要执行删除操作，我们会在配置文件中加入下面的参数来实现自动清理二进制日志的工作</p>
<h2 id="9-1-reset-master"><a href="#9-1-reset-master" class="headerlink" title="9.1.reset master"></a>9.1.reset master</h2><p>删除所有的binlog日志，新日志编号从头开始</p>
<h2 id="9-2-purge-master-logs-to-“mysql-bin-000002”"><a href="#9-2-purge-master-logs-to-“mysql-bin-000002”" class="headerlink" title="9.2.purge master logs to “mysql-bin.000002”"></a>9.2.purge master logs to “mysql-bin.000002”</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#删除mysql-bin.000002之前所有日志，不包含000002自身</div><div class="line">mysql&gt; purge master logs to &quot;mysql-bin.000002&quot;;</div></pre></td></tr></table></figure>
<h2 id="9-3-purge-master-logg-before-“2015-09-11-24-45-56”"><a href="#9-3-purge-master-logg-before-“2015-09-11-24-45-56”" class="headerlink" title="9.3.purge master logg before “2015-09-11 24:45:56”;"></a>9.3.purge master logg before “2015-09-11 24:45:56”;</h2><p>删除指定时间之前的binlog</p>
<h2 id="9-4-配置文件中定义删除指定日期的日志"><a href="#9-4-配置文件中定义删除指定日期的日志" class="headerlink" title="9.4.配置文件中定义删除指定日期的日志"></a>9.4.配置文件中定义删除指定日期的日志</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"> grep expire /data/3309/my.cnf</div><div class="line">expire_logs_days = 7</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/04/16/mysql/mysql的日志/" data-id="cj290sb4j0020ssqq5qn6q953" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/04/16/mysql/mysql数据库安装之后的优化操作/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          mysql数据库安装之后的优化操作
        
      </div>
    </a>
  
  
    <a href="/2017/04/16/mysql/navicat for mysql 快捷键/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">navicat for mysql 快捷键</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/IDEA/">IDEA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/NFS/">NFS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tachyon/">Tachyon</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/azkaban/">azkaban</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/echarts/">echarts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/flume/">flume</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/">hadoop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hbase/">hbase</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hive/">hive</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/inotify/">inotify</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/kafka/">kafka</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/logstash/">logstash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/markdown/">markdown</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/memcached/">memcached</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongodb/">mongodb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/nginx/">nginx</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/project/">project</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/redis/">redis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/rsync/">rsync</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/scala/">scala</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/shell/">shell</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/socket/">socket</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/spark/">spark</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/sqoop/">sqoop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/storm/">storm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据仓库/">数据仓库</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/IDEA/">IDEA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux基础命令/">Linux基础命令</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux重要配置文件/">Linux重要配置文件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NFS/">NFS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NIO/">NIO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/azkaban/">azkaban</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/echarts/">echarts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flume/">flume</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hadoop/">hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hbase/">hbase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hive/">hive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/inotify/">inotify</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/">kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/logstash/">logstash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mapreduce/">mapreduce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdown/">markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/memcached/">memcached</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/netty/">netty</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/project/">project</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rpc/">rpc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rsync/">rsync</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scala/">scala</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scala函数式编程/">scala函数式编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scala编程/">scala编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/socket/">socket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spark/">spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqoop/">sqoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/storm/">storm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zookeeper/">zookeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据仓库/">数据仓库</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/IDEA/" style="font-size: 10px;">IDEA</a> <a href="/tags/Linux基础命令/" style="font-size: 19.52px;">Linux基础命令</a> <a href="/tags/Linux重要配置文件/" style="font-size: 14.76px;">Linux重要配置文件</a> <a href="/tags/NFS/" style="font-size: 10px;">NFS</a> <a href="/tags/NIO/" style="font-size: 11.43px;">NIO</a> <a href="/tags/azkaban/" style="font-size: 10.48px;">azkaban</a> <a href="/tags/echarts/" style="font-size: 10.95px;">echarts</a> <a href="/tags/flume/" style="font-size: 10.95px;">flume</a> <a href="/tags/hadoop/" style="font-size: 18.57px;">hadoop</a> <a href="/tags/hbase/" style="font-size: 13.33px;">hbase</a> <a href="/tags/hive/" style="font-size: 18.1px;">hive</a> <a href="/tags/inotify/" style="font-size: 10px;">inotify</a> <a href="/tags/java/" style="font-size: 12.38px;">java</a> <a href="/tags/kafka/" style="font-size: 12.86px;">kafka</a> <a href="/tags/linux/" style="font-size: 13.33px;">linux</a> <a href="/tags/logstash/" style="font-size: 10.48px;">logstash</a> <a href="/tags/mapreduce/" style="font-size: 16.67px;">mapreduce</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/memcached/" style="font-size: 13.81px;">memcached</a> <a href="/tags/mongodb/" style="font-size: 14.76px;">mongodb</a> <a href="/tags/mysql/" style="font-size: 17.14px;">mysql</a> <a href="/tags/netty/" style="font-size: 10.95px;">netty</a> <a href="/tags/nginx/" style="font-size: 14.29px;">nginx</a> <a href="/tags/project/" style="font-size: 10.48px;">project</a> <a href="/tags/python/" style="font-size: 19.05px;">python</a> <a href="/tags/redis/" style="font-size: 17.14px;">redis</a> <a href="/tags/rpc/" style="font-size: 10.48px;">rpc</a> <a href="/tags/rsync/" style="font-size: 10px;">rsync</a> <a href="/tags/scala/" style="font-size: 17.62px;">scala</a> <a href="/tags/scala函数式编程/" style="font-size: 11.9px;">scala函数式编程</a> <a href="/tags/scala编程/" style="font-size: 15.71px;">scala编程</a> <a href="/tags/shell/" style="font-size: 17.62px;">shell</a> <a href="/tags/socket/" style="font-size: 11.9px;">socket</a> <a href="/tags/spark/" style="font-size: 20px;">spark</a> <a href="/tags/sqoop/" style="font-size: 10.95px;">sqoop</a> <a href="/tags/storm/" style="font-size: 15.24px;">storm</a> <a href="/tags/zookeeper/" style="font-size: 16.19px;">zookeeper</a> <a href="/tags/数据仓库/" style="font-size: 11.43px;">数据仓库</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/05/02/bigdata/spark从入门到精通_笔记/Tachyon/">Tachyon</a>
          </li>
        
          <li>
            <a href="/2017/04/30/数据仓库/数据仓库2/">数据仓库</a>
          </li>
        
          <li>
            <a href="/2017/04/29/IDEA/IDEA/">IDEA</a>
          </li>
        
          <li>
            <a href="/2017/04/29/数据仓库/ETL/">ETL</a>
          </li>
        
          <li>
            <a href="/2017/04/28/数据仓库/PowderDesigner/">PowderDesigner的使用</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Mr. Chen<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>




  </div>
</body>
</html>